import{ba as b,a as W,r as p,Q as X,o as Y,az as Z,bi as K,f as v,s as T,y as e,w as r,h as ee,g as h,V as k,k as i,j as ae,b8 as x,F as te,an as N,bb as u,Z as le,W as oe,X as re,E as se,Y as ne,M as ie}from"./index-6b4a7109.js";import{E as de}from"./el-dialog-3c4d9b63.js";import"./el-overlay-14cb1ada.js";import{E as me}from"./el-progress-55567651.js";/* empty css                */import{E as ce}from"./el-pagination-4cd73be8.js";import{E as pe,a as ue,b as _e}from"./el-message-ff3fa38d.js";/* empty css                   */import{E as ge}from"./el-button-f9e23ee8.js";import"./refs-7cd368e8.js";import"./vnode-4d5e77cb.js";const fe=(d,s)=>b.get(`/admin/product/baseTrademark/${d}/${s}`),ve=d=>d.id?b.put("/admin/product/baseTrademark/update",d):b.post("/admin/product/baseTrademark/save",d),be=d=>b.delete("/admin/product/baseTrademark/remove/"+d),ye=["src"],ke=["src"],xe=W({__name:"index",setup(d){let s=p(1),_=p(3),E=p(0),m=p(!1),y=p([]),o=X({tmName:"",logoUrl:""}),c=p();const g=async(t=1)=>{s.value=t;let a=await fe(s.value,_.value);a.code===200&&(E.value=a.data.total,y.value=a.data.records)};Y(()=>{g()});const C=()=>{g()},V=()=>{m.value=!0,o.id=0,o.tmName="",o.logoUrl="",N(()=>{c.value.clearValidate("tmName"),c.value.clearValidate("logoUrl")})},z=t=>{N(()=>{c.value.clearValidate("tmName"),c.value.clearValidate("logoUrl")}),m.value=!0,Object.assign(o,t)},w=()=>{m.value=!1},M=async()=>{await c.value.validate(),(await ve(o)).code===200?(m.value=!1,u({type:"success",message:o.id?"修改品牌成功":"添加品牌成功"}),g(o.id?s.value:1)):u({type:"error",message:o.id?"修改品牌失败":"添加品牌失败"})},P=t=>{if(t.type==="image/png"||t.type==="image/jpeg"||t.type==="image/gif"){if(t.size/1024/1024<4)return!0;u({type:"error",message:"上传的文件大小应小于4M"})}else return u({type:"error",message:"上传的文件类型必须是PNG|JPG|GIF"}),!1},q=(t,a)=>{o.logoUrl=t.data,c.value.clearValidate("logoUrl")},D={tmName:[{required:!0,trigger:"blur",validator:(t,a,n)=>{a.trim().length>=2?n():n(new Error("品牌名称位数大于等于两位"))}}],logoUrl:[{required:!0,trigger:"change",validator:(t,a,n)=>{a?n():n(new Error("Logo的图片务必上传"))}}]},I=async t=>{(await be(t)).code===200?(u({type:"success",message:"删除品牌成功"}),g(y.value.length>1?s.value:s.value-1)):u({type:"error",message:"删除品牌失败"})};return(t,a)=>{const n=ge,f=pe,L=ue,j=_e,A=ce,F=le,G=oe,U=re,O=Z("Plus"),$=se,B=me,R=ne,S=de,H=K("has");return v(),T(te,null,[e(F,{class:"box-card"},{default:r(()=>[ee((v(),h(n,{type:"primary",size:"default",icon:"Plus",onClick:V},{default:r(()=>[k(" 添加品牌 ")]),_:1})),[[H,"btn.Trademark.add"]]),e(j,{style:{margin:"10px 0"},border:"",data:i(y)},{default:r(()=>[e(f,{label:"序号",width:"80px",align:"center",type:"index"}),e(f,{label:"品牌名称",prop:"tmName"}),e(f,{label:"品牌LOGO"},{default:r(({row:l,$index:J})=>[ae("img",{src:l.logoUrl,alt:"图片丢失了~",style:{width:"100px",height:"100px"}},null,8,ye)]),_:1}),e(f,{label:"品牌操作"},{default:r(({row:l,$index:J})=>[e(n,{type:"primary",size:"small",icon:"Edit",onClick:Q=>z(l)},null,8,["onClick"]),e(L,{title:`您确定删除${l.tmName}`,width:"250px",icon:"delete",onConfirm:Q=>I(l.id)},{reference:r(()=>[e(n,{type:"danger",size:"small",icon:"Delete"})]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"]),e(A,{"current-page":i(s),"onUpdate:currentPage":a[0]||(a[0]=l=>x(s)?s.value=l:s=l),"page-size":i(_),"onUpdate:pageSize":a[1]||(a[1]=l=>x(_)?_.value=l:_=l),"page-sizes":[3,5,7,9],background:!0,layout:"prev, pager, next, jumper, ->, sizes, total",total:i(E),onCurrentChange:g,onSizeChange:C},null,8,["current-page","page-size","total"])]),_:1}),e(S,{modelValue:i(m),"onUpdate:modelValue":a[3]||(a[3]=l=>x(m)?m.value=l:m=l),title:i(o).id?"修改品牌":"添加品牌"},{footer:r(()=>[e(n,{type:"primary",size:"default",onClick:w},{default:r(()=>[k("取消")]),_:1}),e(n,{type:"primary",size:"default",onClick:M},{default:r(()=>[k("确定")]),_:1})]),default:r(()=>[e(R,{style:{width:"90%"},model:i(o),rules:D,ref_key:"formRef",ref:c},{default:r(()=>[e(U,{label:"品牌名称","label-width":"100px",prop:"tmName"},{default:r(()=>[e(G,{placeholder:"请您输入品牌名称",modelValue:i(o).tmName,"onUpdate:modelValue":a[2]||(a[2]=l=>i(o).tmName=l)},null,8,["modelValue"])]),_:1}),e(U,{label:"品牌Logo","label-width":"100px",prop:"logoUrl"},{default:r(()=>[e(B,{class:"avatar-uploader",action:"/api/admin/product/fileUpload","show-file-list":!1,"on-success":q,"before-upload":P},{default:r(()=>[i(o).logoUrl?(v(),T("img",{key:0,src:i(o).logoUrl,class:"avatar"},null,8,ke)):(v(),h($,{key:1,class:"avatar-uploader-icon"},{default:r(()=>[e(O)]),_:1}))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])],64)}}});const Ie=ie(xe,[["__scopeId","data-v-865beb3f"]]);export{Ie as default};
