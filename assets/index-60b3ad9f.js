import{aQ as u,a as B,r as g,Q as F,o as T,f as U,s as j,y as e,w as a,k as i,aR as y,F as w,V as r,t as z,j as A,aS as V,W as D,X as N,Y as O}from"./index-5bef0582.js";import{E as R}from"./el-dialog-aa0f1270.js";import"./el-overlay-68a79402.js";import{b as I,E as Q,a as S}from"./el-message-f959450d.js";import"./el-tooltip-4ed993c7.js";import{E as h}from"./el-button-dd364e49.js";import"./refs-8cd534d9.js";import"./vnode-df13de24.js";const H=()=>u.get("/admin/acl/permission"),W=d=>d.id?u.put("/admin/acl/permission/update",d):u.post("/admin/acl/permission/save",d),X=d=>u.delete("/admin/acl/permission/remove/"+d),Y={class:"dialog-footer"},oe=B({__name:"index",setup(d){let c=g([]),t=g(!1),o=F({code:"",level:0,name:"",pid:0});T(()=>{f()});const f=async()=>{let s=await H();s.code===200&&(c.value=s.data)},E=s=>{Object.assign(o,{id:0,code:"",level:0,name:"",pid:0}),t.value=!0,o.level=s.level+1,o.pid=s.id},C=s=>{t.value=!0,Object.assign(o,s)},k=async()=>{t.value=!1,(await W(o)).code===200&&(t.value=!1,V({type:"success",message:o.id?"更新成功":"添加成功"}),f())},x=async s=>{(await X(s)).code===200&&V({type:"success",message:"删除成功"})};return(s,n)=>{const p=Q,m=h,P=S,M=I,_=D,v=N,$=O,q=R;return U(),j(w,null,[e(M,{style:{width:"100%","margin-bottom":"20px"},"row-key":"id",border:"",data:i(c)},{default:a(()=>[e(p,{prop:"name",label:"名称"}),e(p,{prop:"code",label:"权限值"}),e(p,{prop:"updateTime",label:"修改时间","show-overflow-tooltip":""}),e(p,{label:"操作",width:"260px"},{default:a(({row:l,$index:G})=>[e(m,{size:"small",disabled:l.level===4,onClick:b=>E(l)},{default:a(()=>[r(z(l.level===3?"添加功能":"添加菜单"),1)]),_:2},1032,["disabled","onClick"]),e(m,{type:"primary",size:"small",disabled:l.level===1,onClick:b=>C(l)},{default:a(()=>[r(" 编辑 ")]),_:2},1032,["disabled","onClick"]),e(P,{title:`你确定要删除${l.name}?`,width:"260px",onConfirm:b=>x(l.id)},{reference:a(()=>[e(m,{type:"danger",size:"small",disabled:l.level===1},{default:a(()=>[r(" 删除 ")]),_:2},1032,["disabled"])]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"]),e(q,{modelValue:i(t),"onUpdate:modelValue":n[3]||(n[3]=l=>y(t)?t.value=l:t=l),title:i(o).id?"更新菜单":"添加菜单"},{footer:a(()=>[A("span",Y,[e(m,{onClick:n[2]||(n[2]=l=>y(t)?t.value=!1:t=!1)},{default:a(()=>[r("取消")]),_:1}),e(m,{type:"primary",onClick:k},{default:a(()=>[r("确定")]),_:1})])]),default:a(()=>[e($,null,{default:a(()=>[e(v,{label:"名称"},{default:a(()=>[e(_,{placeholder:"请你输入菜单的名称",modelValue:i(o).name,"onUpdate:modelValue":n[0]||(n[0]=l=>i(o).name=l)},null,8,["modelValue"])]),_:1}),e(v,{label:"权限"},{default:a(()=>[e(_,{placeholder:"请你输入权限数值",modelValue:i(o).code,"onUpdate:modelValue":n[1]||(n[1]=l=>i(o).code=l)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","title"])],64)}}});export{oe as default};
